<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>skilletobviously's Chess Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #0f0f1a 0%, #1a1a2e 50%, #16213e 100%);
            color: #e0e0e0;
            min-height: 100vh;
            padding: 2rem;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 3rem;
        }

        h1 {
            font-size: 2.5rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
        }

        .subtitle {
            color: #888;
            font-size: 0.9rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 1.5rem;
            text-align: center;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 40px rgba(102, 126, 234, 0.2);
        }

        .stat-card .icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .stat-card .value {
            font-size: 2rem;
            font-weight: 700;
            color: #fff;
        }

        .stat-card .label {
            color: #888;
            font-size: 0.85rem;
            margin-top: 0.25rem;
        }

        .stat-card.win .value { color: #4ade80; }
        .stat-card.loss .value { color: #f87171; }
        .stat-card.draw .value { color: #fbbf24; }

        .streak-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border-radius: 50px;
            font-weight: 600;
            font-size: 1.1rem;
            margin: 1rem 0 2rem;
        }

        .streak-badge.win {
            background: linear-gradient(135deg, rgba(74, 222, 128, 0.2), rgba(34, 197, 94, 0.1));
            border: 1px solid rgba(74, 222, 128, 0.3);
            color: #4ade80;
        }

        .streak-badge.loss {
            background: linear-gradient(135deg, rgba(248, 113, 113, 0.2), rgba(239, 68, 68, 0.1));
            border: 1px solid rgba(248, 113, 113, 0.3);
            color: #f87171;
        }

        .streak-badge.draw {
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.2), rgba(245, 158, 11, 0.1));
            border: 1px solid rgba(251, 191, 36, 0.3);
            color: #fbbf24;
        }

        section {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
        }

        h2 {
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        h2 .emoji {
            font-size: 1.75rem;
        }

        .chart-container {
            height: 250px;
            position: relative;
        }

        .openings-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 1rem;
        }

        .opening-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 1rem;
            text-align: center;
            transition: transform 0.2s;
        }

        .opening-card:hover {
            transform: scale(1.02);
        }

        .opening-card.best {
            border: 1px solid rgba(74, 222, 128, 0.3);
        }

        .opening-card.worst {
            border: 1px solid rgba(248, 113, 113, 0.3);
        }

        .opening-card img {
            width: 120px;
            height: 120px;
            border-radius: 8px;
            margin-bottom: 0.75rem;
        }

        .opening-card h4 {
            font-size: 0.9rem;
            color: #fff;
            margin-bottom: 0.5rem;
            height: 2.5em;
            overflow: hidden;
        }

        .win-rate {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .progress-bar {
            flex: 1;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 4px;
        }

        .opening-card.best .progress {
            background: linear-gradient(90deg, #4ade80, #22c55e);
        }

        .opening-card.worst .progress {
            background: linear-gradient(90deg, #f87171, #ef4444);
        }

        .record {
            font-size: 0.8rem;
            color: #888;
        }

        .game-header {
            display: flex;
            align-items: center;
            gap: 2rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .result-badge {
            font-size: 1.5rem;
            font-weight: 700;
            padding: 0.5rem 1.5rem;
            border-radius: 12px;
        }

        .result-badge.win {
            background: rgba(74, 222, 128, 0.2);
            color: #4ade80;
        }

        .result-badge.loss {
            background: rgba(248, 113, 113, 0.2);
            color: #f87171;
        }

        .result-badge.draw {
            background: rgba(251, 191, 36, 0.2);
            color: #fbbf24;
        }

        .game-meta {
            display: flex;
            gap: 2rem;
            color: #888;
        }

        .game-meta span {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .game-meta .color-icon {
            font-size: 1.5rem;
        }

        .view-game-btn {
            display: inline-block;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #fff;
            text-decoration: none;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-weight: 500;
            margin-left: auto;
            transition: opacity 0.2s;
        }

        .view-game-btn:hover {
            opacity: 0.9;
        }

        .analysis-section {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 12px;
            padding: 1.25rem;
            margin-bottom: 1rem;
        }

        .analysis-section h4 {
            color: #667eea;
            margin-bottom: 0.5rem;
            font-size: 1rem;
        }

        .analysis-section p {
            line-height: 1.6;
            color: #ccc;
        }

        .analysis-section.highlight {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
            border: 1px solid rgba(102, 126, 234, 0.3);
        }

        .analysis-section.highlight h4 {
            color: #a78bfa;
        }

        .analysis-section.blunder {
            background: linear-gradient(135deg, rgba(248, 113, 113, 0.1), rgba(239, 68, 68, 0.05));
            border: 1px solid rgba(248, 113, 113, 0.3);
        }

        .analysis-section.blunder h4 {
            color: #f87171;
        }

        .analysis-section.miss {
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.1), rgba(245, 158, 11, 0.05));
            border: 1px solid rgba(251, 191, 36, 0.3);
        }

        .analysis-section.miss h4 {
            color: #fbbf24;
        }

        .analysis-section.good {
            background: linear-gradient(135deg, rgba(74, 222, 128, 0.1), rgba(34, 197, 94, 0.05));
            border: 1px solid rgba(74, 222, 128, 0.3);
        }

        .analysis-section.good h4 {
            color: #4ade80;
        }

        .endgame-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }

        .endgame-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
        }

        .endgame-card h4 {
            font-size: 1rem;
            margin-bottom: 1rem;
            color: #fff;
        }

        .endgame-card .big-number {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .endgame-card.winning .big-number { color: #4ade80; }
        .endgame-card.losing .big-number { color: #f87171; }
        .endgame-card.equal .big-number { color: #fbbf24; }

        .endgame-card .detail {
            color: #888;
            font-size: 0.85rem;
        }

        footer {
            text-align: center;
            color: #666;
            font-size: 0.85rem;
            margin-top: 2rem;
        }

        footer a {
            color: #667eea;
            text-decoration: none;
        }

        .refresh-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #fff;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            margin-top: 1rem;
            transition: transform 0.2s, box-shadow 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .refresh-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        .refresh-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .refresh-btn.loading .refresh-icon {
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .refresh-icon {
            font-size: 1.2rem;
            display: inline-block;
        }

        .toast {
            position: fixed;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            color: #fff;
            padding: 1rem 2rem;
            border-radius: 12px;
            font-size: 0.95rem;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .toast.show {
            opacity: 1;
        }

        .toast.success {
            border: 1px solid rgba(74, 222, 128, 0.5);
        }

        .toast.error {
            border: 1px solid rgba(248, 113, 113, 0.5);
        }

        @media (max-width: 768px) {
            body {
                padding: 1rem;
            }

            h1 {
                font-size: 1.75rem;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .game-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }

            .view-game-btn {
                margin-left: 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>&#9823; skilletobviously's Chess Dashboard</h1>
            <p class="subtitle">Auto-updated every hour &bull; Last update: 2026-02-10 08:09 UTC</p>
            <button id="refreshBtn" class="refresh-btn" onclick="refreshDashboard()">
                <span class="refresh-icon">&#8635;</span> Update Now
            </button>
        </header>

        <div class="stats-grid">
            <div class="stat-card">
                <div class="icon">&#127919;</div>
                <div class="value">641</div>
                <div class="label">Current Rating</div>
            </div>
            <div class="stat-card">
                <div class="icon">&#11088;</div>
                <div class="value">714</div>
                <div class="label">Peak Rating</div>
            </div>
            <div class="stat-card win">
                <div class="icon">&#9989;</div>
                <div class="value">102</div>
                <div class="label">Wins</div>
            </div>
            <div class="stat-card loss">
                <div class="icon">&#10060;</div>
                <div class="value">89</div>
                <div class="label">Losses</div>
            </div>
            <div class="stat-card">
                <div class="icon">&#10134;</div>
                <div class="value">9</div>
                <div class="label">Draws</div>
            </div>
            <div class="stat-card">
                <div class="icon">&#128200;</div>
                <div class="value">51%</div>
                <div class="label">Win Rate</div>
            </div>
        </div>

        <div style="text-align: center;">
            <div class="streak-badge loss">
                <span>&#10052;</span>
                <span>Current Streak: 2 Losses</span>
            </div>
        </div>

        <section>
            <h2><span class="emoji">&#127918;</span> Most Recent Game</h2>
            <div class="game-header">
                <div class="result-badge loss">Lost</div>
                <div class="game-meta">
                    <span><span class="color-icon">&#9817;</span> Played as White</span>
                    <span>vs rageholy (639)</span>
                    <span>Rapid</span>
                </div>
                <a href="https://www.chess.com/game/live/164471220294" class="view-game-btn" target="_blank">View Game &#8594;</a>
            </div>

            <h3 style="margin-bottom: 1rem; color: #888; font-size: 1rem;">&#128269; Game Analysis</h3>
            <div class="analysis-section">
<h4>Opening Assessment</h4>
<p>You opened with the Bishop's Opening (1.e4 e5 2.Bc4), which is a solid choice. However, the early queen development with 3.Qf3 and the awkward knight maneuver 4.Nh3 gave Black easy equality and even a slight initiative with moves like 5...b5 attacking your bishop.</p>
</div>

<div class="analysis-section">
<h4>Critical Moment</h4>
<p>The critical turning point occurred in the endgame around move 72 with Kb4, which was a devastating blunder that lost nearly 95 pawns of advantage according to the engine. This move allowed Black's rook to dominate completely with checks and forced your king into a losing position. From this point forward, you were essentially in a lost endgame despite having reasonable chances before.</p>
</div>

<div class="analysis-section blunder">
<h4>Notable Blunders</h4>
<p><strong>72.Kb4</strong> was a massive blunder that lost the game - this allowed Black's rook to give devastating checks with 72...Rb6+, forcing your king into worse and worse squares. Instead, you needed to keep your king more centralized to maintain drawing chances. <strong>74.Kc5</strong> compounded the error by walking into another rook check, when you should have tried to activate your king toward Black's pawns. <strong>80.Kc3</strong> was the final nail in the coffin, allowing Black's rook to dominate completely - by this point you needed to try desperate counterplay rather than passive king moves.</p>
</div>

<div class="analysis-section miss">
<h4>Notable Misses</h4>
<p><strong>17.Rae1</strong> missed the strong central break 17.e5!, which would have opened lines for your pieces and given you a significant advantage. <strong>18.Qh5+</strong> again missed the powerful 18.e5!, which would have been much stronger than the queen check that just drove Black's king to safety. <strong>33.Ne7</strong> missed 33.Qh7+, which would have maintained more pressure on Black's exposed king position instead of allowing the queen trade.</p>
</div>

<div class="analysis-section good">
<h4>Notable Good Moves</h4>
<p><strong>13.Nxc5</strong> was an excellent tactical shot, winning Black's advanced pawn and gaining a material advantage in the center. <strong>65.e7</strong> showed good technique in the endgame, advancing your passed pawn to the seventh rank and creating maximum pressure. <strong>85.Kf3</strong> was a well-timed king activation that improved your position significantly, though by then the game was already very difficult.</p>
</div>

<div class="analysis-section">
<h4>Endgame Notes</h4>
<p>The endgame was the decisive phase where the game was lost. Your king became too passive and allowed Black's rook to dominate with checks, while Black's passed pawns became unstoppable. In rook endgames, active piece play is crucial - your rook needed to stay active while your king should have been more aggressive in targeting Black's pawns.</p>
</div>

<div class="analysis-section highlight">
<h4>Key Lesson</h4>
<p>Focus on rook endgame principles, particularly keeping your rook active and your king centralized. The blunders on moves 72, 74, and 80 all involved passive king play - in rook endgames, you must keep your pieces active and look for counterplay rather than allowing your opponent's pieces to dominate your position with checks.</p>
</div>
        </section>

        <section>
            <h2><span class="emoji">&#128200;</span> Rating Trend</h2>
            <div class="chart-container">
                <canvas id="ratingChart"></canvas>
            </div>
        </section>

        <section>
            <h2><span class="emoji">&#127942;</span> Best Openings</h2>
            <div class="openings-container">
                
        <div class="opening-card best">
            <img src="https://lichess1.org/export/fen.gif?fen=rnbqkbnr%2Fpppppppp%2F8%2F8%2F4P3%2F8%2FPPPP1PPP%2FRNBQKBNR%20b%20KQkq%20e3%200%201&color=white&theme=brown&piece=cburnett" alt="Kings Pawn Opening Leonardis V">
            <h4>Kings Pawn Opening Leonardis</h4>
            <div class="win-rate">
                <div class="progress-bar">
                    <div class="progress" style="width: 75.0%"></div>
                </div>
                <span>75%</span>
            </div>
            <div class="record">3W - 1L - 0D</div>
        </div>
        
        <div class="opening-card best">
            <img src="https://lichess1.org/export/fen.gif?fen=r1bqkb1r%2Fpppp1ppp%2F2n2n2%2F4p3%2F4P3%2F2N2N2%2FPPPP1PPP%2FR1BQKB1R%20w%20KQkq%20-%204%204&color=white&theme=brown&piece=cburnett" alt="Four Knights Game Italian Vari">
            <h4>Four Knights Game Italian Va</h4>
            <div class="win-rate">
                <div class="progress-bar">
                    <div class="progress" style="width: 75.0%"></div>
                </div>
                <span>75%</span>
            </div>
            <div class="record">3W - 1L - 0D</div>
        </div>
        
        <div class="opening-card best">
            <img src="https://lichess1.org/export/fen.gif?fen=rnbqkbnr%2Fpppp1ppp%2F8%2F4p3%2F2B1P3%2F8%2FPPPP1PPP%2FRNBQK1NR%20b%20KQkq%20-%201%202&color=white&theme=brown&piece=cburnett" alt="Bishops Opening Berlin Defense">
            <h4>Bishops Opening Berlin Defen</h4>
            <div class="win-rate">
                <div class="progress-bar">
                    <div class="progress" style="width: 75.0%"></div>
                </div>
                <span>75%</span>
            </div>
            <div class="record">3W - 1L - 0D</div>
        </div>
        
            </div>
        </section>

        <section>
            <h2><span class="emoji">&#128218;</span> Openings to Study</h2>
            <div class="openings-container">
                
        <div class="opening-card worst">
            <img src="https://lichess1.org/export/fen.gif?fen=rnbqkbnr%2Fppp1pppp%2F3p4%2F8%2F4P3%2F8%2FPPPP1PPP%2FRNBQKBNR%20w%20KQkq%20-%200%202&color=white&theme=brown&piece=cburnett" alt="Pirc Defense 2.Bc4">
            <h4>Pirc Defense 2.Bc4</h4>
            <div class="win-rate">
                <div class="progress-bar">
                    <div class="progress" style="width: 25.0%"></div>
                </div>
                <span>25%</span>
            </div>
            <div class="record">1W - 3L - 0D</div>
        </div>
        
        <div class="opening-card worst">
            <img src="https://lichess1.org/export/fen.gif?fen=rnbqkbnr%2Fpppp1ppp%2F4p3%2F8%2F4P3%2F8%2FPPPP1PPP%2FRNBQKBNR%20w%20KQkq%20-%200%202&color=white&theme=brown&piece=cburnett" alt="French Defense">
            <h4>French Defense</h4>
            <div class="win-rate">
                <div class="progress-bar">
                    <div class="progress" style="width: 25.0%"></div>
                </div>
                <span>25%</span>
            </div>
            <div class="record">1W - 3L - 0D</div>
        </div>
        
        <div class="opening-card worst">
            <img src="https://lichess1.org/export/fen.gif?fen=r1bqkbnr%2Fpppp1ppp%2F2n5%2F4p3%2F4P3%2F2N2N2%2FPPPP1PPP%2FR1BQKB1R%20b%20KQkq%20-%203%203&color=white&theme=brown&piece=cburnett" alt="Three Knights Opening 3...Bc5">
            <h4>Three Knights Opening 3...Bc</h4>
            <div class="win-rate">
                <div class="progress-bar">
                    <div class="progress" style="width: 0.0%"></div>
                </div>
                <span>0%</span>
            </div>
            <div class="record">0W - 3L - 1D</div>
        </div>
        
            </div>
        </section>

        <section>
            <h2><span class="emoji">&#9812;</span> Endgame Performance</h2>
            <div class="endgame-grid">
                <div class="endgame-card winning">
                    <h4>&#11014;&#65039; Winning Positions</h4>
                    <div class="big-number">69%</div>
                    <div class="detail">9 converted / 13 games</div>
                    <div class="detail">Drew 3 &bull; Lost 1</div>
                </div>
                <div class="endgame-card losing">
                    <h4>&#11015;&#65039; Losing Positions</h4>
                    <div class="big-number">20%</div>
                    <div class="detail">6 saved / 30 games</div>
                    <div class="detail">Wins + Draws from behind</div>
                </div>
                <div class="endgame-card equal">
                    <h4>&#9878;&#65039; Equal Positions</h4>
                    <div class="big-number">29%</div>
                    <div class="detail">2 won / 7 games</div>
                    <div class="detail">Drew 1 &bull; Lost 4</div>
                </div>
            </div>
        </section>

        <footer>
            <p>Powered by <a href="https://www.chess.com/member/skilletobviously" target="_blank">Chess.com</a> API &amp; Claude AI</p>
        </footer>
    </div>

    <script>
        const ctx = document.getElementById('ratingChart').getContext('2d');
        const ratings = [713, 705, 713, 705, 698, 706, 714, 706, 698, 706, 713, 705, 713, 705, 697, 689, 681, 673, 664, 672, 680, 688, 688, 680, 672, 664, 656, 657, 649, 641];
        const dates = ["2026-02-02", "2026-02-02", "2026-02-02", "2026-02-02", "2026-02-03", "2026-02-03", "2026-02-03", "2026-02-03", "2026-02-03", "2026-02-03", "2026-02-04", "2026-02-04", "2026-02-04", "2026-02-04", "2026-02-05", "2026-02-05", "2026-02-05", "2026-02-06", "2026-02-06", "2026-02-06", "2026-02-06", "2026-02-07", "2026-02-08", "2026-02-08", "2026-02-08", "2026-02-08", "2026-02-09", "2026-02-09", "2026-02-09", "2026-02-09"];

        new Chart(ctx, {
            type: 'line',
            data: {
                labels: dates,
                datasets: [{
                    label: 'Rating',
                    data: ratings,
                    borderColor: '#667eea',
                    backgroundColor: 'rgba(102, 126, 234, 0.1)',
                    borderWidth: 2,
                    fill: true,
                    tension: 0.4,
                    pointRadius: 0,
                    pointHoverRadius: 6,
                    pointHoverBackgroundColor: '#667eea',
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        backgroundColor: 'rgba(0, 0, 0, 0.8)',
                        titleColor: '#fff',
                        bodyColor: '#fff',
                        padding: 12,
                        displayColors: false,
                    }
                },
                scales: {
                    x: {
                        display: false
                    },
                    y: {
                        grid: {
                            color: 'rgba(255, 255, 255, 0.05)'
                        },
                        ticks: {
                            color: '#888'
                        }
                    }
                }
            }
        });
    </script>
    <div id="toast" class="toast"></div>

    <script>
        const API_URL = 'https://chess-dashboard-seven.vercel.app/api/refresh';

        function showToast(message, type) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = 'toast show ' + type;
            setTimeout(() => {
                toast.className = 'toast';
            }, 4000);
        }

        async function refreshDashboard() {
            const btn = document.getElementById('refreshBtn');
            btn.disabled = true;
            btn.classList.add('loading');
            btn.innerHTML = '<span class="refresh-icon">&#8635;</span> Updating...';

            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                });

                const data = await response.json();

                if (response.ok) {
                    showToast('Update triggered! Page will refresh in ~60 seconds.', 'success');
                    // Auto-reload after 60 seconds
                    setTimeout(() => {
                        window.location.reload();
                    }, 60000);
                } else {
                    showToast('Error: ' + (data.error || 'Unknown error'), 'error');
                }
            } catch (error) {
                showToast('Error: ' + error.message, 'error');
            } finally {
                btn.disabled = false;
                btn.classList.remove('loading');
                btn.innerHTML = '<span class="refresh-icon">&#8635;</span> Update Now';
            }
        }
    </script>
</body>
</html>